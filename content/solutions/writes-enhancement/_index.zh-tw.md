---
title: 瞬間大量資料庫寫入挑戰
resources:
  - name: merge-replication
    src: "mr.png"
    title: "程式無需改動並維持舊有介接方式，利用多個資料庫處理分散處理第一線寫入需求"
  - name: sharding
    src: "sharding.png"
    title: "利用 GRAVITY 實現資料分片"
  - name: mr-and-sharding
    src: "mr_and_sharding.png"
    title: "寫入緩衝、分片機制，利用 GRAVITY 所有好處通通都一次實現"
  - name: chain-solution
    src: "chain_solution.png"
    title: "重複利用分片機制，進行更多的分片節點擴展"
---

瞬間大量的資料庫寫入工作，總造成資料庫效能衝擊，嚴重時甚至讓整個應用系統都無法正常運行。對於終端應用來說，資料庫寫入效率與使用者體驗直接相關，極差的寫入效率常讓企業蒙受巨量交易損失，面對大量的寫入壓力而造成系統崩潰時，更嚴重讓企業形象受損。然而，改造資料寫入效率，往往需要從應用程式到資料庫系統進行大範圍的改造，不但改造風險高也相當麻煩。

為此，GRAVITY 提供企業一種解決方案，在不涉及資料庫系統本身的改動、無需架設和管理複雜的資料庫叢集、也無需強迫應用程式放棄舊有的資料庫系統的前提下，強化資料的寫入效率。

關於寫入效率的改善，可以參考以下解決方案：

{{< toc >}}

## 為資料庫系統創造寫入緩衝，承受第一時間的瞬間寫入轟炸

瞬間大量的資料寫入，總是會直接造成資料庫巨大的系統壓力，其根本原因是寫入工作會因資料鎖表、建立索引機制等行為，帶來大量資料庫運算資源的消耗，這導致相對於查詢工作來說，寫入操作更是一個資料庫系統的效能殺手。因此，為既有資料庫系統創造寫入緩衝區，避免第一時間的寫入需求直接衝擊原始資料庫，就是一個必要的做法。

{{< img name="merge-replication" size="small" lazy=true >}}

打造寫入的緩衝有許多作法，可由於我們並不想改動應用程式，想維持原本資料庫介接的方式，這時可以搭建生成多組臨時資料庫充當原資料庫系統的分身，讓寫入工作分流至不同的資料庫節點上進行寫入，以承受瞬間資料寫入的工作。然後利用 GRAVITY 實現合併複寫（Merge Replication），將多個資料庫節點的資料，逐步同步至原始資料庫，其同步過程中甚至可以利用批次寫入的方式，盡可能減少資料庫的壓力和提高寫入工作的處理效率。

{{< hint info >}}
**優點**

* 在這樣的方案下，資料庫寫入效率能隨著緩衝節點的動態增加擴展而得到提升。
* 應用程式對資料庫的介接方式無需改變
{{< /hint >}}

---

## 打造非侵入式的分片機制，讓寫入效能真正得到提升

{{< img name="sharding" size="small" lazy=true >}}

將資料以特定規則分類、分流寫入不同資料節點儲存，是一個相當常見的手段以提升寫入能力。只是，過去打造分片機制，需要仰賴複雜的資料庫叢集機制，需要專業的設定、維護措施，實現上相當麻煩且沒有效率。在一些沒有官方支援分片的資料庫系統上，實現分片更要完全依靠開發人員自行打造，非常痛苦。為了能更輕鬆打造分片架構，只需要使用 GRAVITY 的幾行設定，指定資料寫入多個目標資料庫，即可馬上實現分片機制。

{{< hint info >}}
**優點**

* 改善資料庫寫入並保存資料的效能表現
{{< /hint >}}

---

## 應用程式完全不想改，但瞬間寫入、分片機制通通都要

我們都很貪心，那就用 GRAVITY 一次搞定吧！打造寫入緩衝節點，然後同時實現合併複寫（Merge Replication）並以分片的形式寫到多個目標資料庫，就可以通通都要。

{{< img name="mr-and-sharding" size="small" lazy=true >}}

---

## 分片節點不夠，持續再強化擴展

覺得還不夠嗎？您可以利用 GRAVITY 的節點對連架構，進一步擴充資料分片節點的規模，擴充彈性沒有極限。

{{< img name="chain-solution" size="small" lazy=true >}}
